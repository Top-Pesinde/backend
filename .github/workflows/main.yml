# İş akışının adı (GitHub Actions arayüzünde görünür)
name: SSH ile Sunucuya Bağlan

# Bu iş akışının ne zaman tetikleneceğini belirler
on:
  # SADECE "main" branch'ine bir push (kod gönderme) yapıldığında çalışır
  push:
    branches:
      - main

# Çalıştırılacak işlerin listesi
jobs:
  # "sunucuya-baglan" adında bir iş
  sunucuya-baglan:
    # Bu işin çalışacağı sanal makinenin işletim sistemi
    runs-on: ubuntu-latest

    # İşin içinde sırayla çalıştırılacak adımlar
    steps:
      # Adım 1: SSH bağlantısı kuran ve komut çalıştıran eylem
      - name: Sunucuya SSH ile bağlan ve komut çalıştır
        uses: appleboy/ssh-action@master
        with:
          host: "1176.96.131.222"
          username: "root"
          password: "Manavgat07"
          port: 22 # Varsayılan port 22'dir, farklıysa değiştirin.
          script: |
            echo "Sunucuya başarıyla bağlandım!"
            ls -la
            echo "$GITHUB_ACTION_PATH" >> $GITHUB_PATH
            ./entrypoint.sh
